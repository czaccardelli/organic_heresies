# called in addition to base on_faith_monthly actions in common/on_action/religion_on_action
on_faith_monthly = {
	on_actions = {
		faith_heresy_spread_pulse
	}	
}

faith_heresy_spread_pulse = {
    trigger = {
        any_province = {
            county = {
                has_county_modifier = heretic_stronghold_modifier
                faith = root
            }
        }
    }
    effect = {
        every_province = {
            save_temporary_scope_as = heresiarch_province
            every_pool_character = {
                province = scope:heresiarch_province
                limit = {
                    has_trait = heresiarch
                    faith = root
                    # location filter is necessary because the 'province = blah' field in *_pool_character actually checks every pool character in the duchy that contains the province
                    # which causes the effect to fire X times where X = number of provinces in the duchy
                    location = scope:heresiarch_province
                }
                save_scope_as = debug_scope
                every_player = {
                    send_interface_message = {
                        type = event_generic_neutral
                        # DEBUG
                        title = heretic_stronghold_modifier
                        custom_tooltip = debug_def
                    }
                }
                heresiarch_county_conversion_tick_effect = {
                    HERESIARCH = this
                }
            }
        }

    }
    #events = {
    #    organic_heresy.0011
    #}    
}